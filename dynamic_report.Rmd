---
title: My dynamic report
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE,fig.width = 6, fig.height = 4)
library(tidyverse)
```

```{css}
body {
    color:  #0B5345    ;
    background-color: #EAF2F8       ;
    font-family:'Georgia',cursive;
}
h1 {
  color: #0B5345    ;
  background-color: white;
  padding: 50px;
  font-weight : bold

}
h2 {
  color:#0B5345    ;
  background-color: white;
  font-weight : bold;
}



```


## How the temperature and the Weather Type affect the Visibility?

```{r}

#loading data from csv url

csv_file <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vQDOfFFR4SL_dCeIpvr_rrdFjkmHGmVdblsf9baVI_DRPOfmDMr2zr6fH2eVAh3ju9UBdk0q093f-HR/pub?gid=1796296273&single=true&output=csv"
logged_data <- read_csv(csv_file) 



#renaming columns for easy references

latest_data <- logged_data %>%
  rename(Temperature = 'What is the temperature (In Celcius) this time?',
    Weather = 'What is the general weather condition?',
    Humidity = 'What is the humidity (in %)?',
    Wind_Speed = 'What is the Wind Speed (km/h) ?',
    Visibility = 'What is the Visibility?')

latest_data


```


```{r}
#Calculating min temp
minimum_temp <- min(latest_data$Temperature, na.rm =TRUE)
print(minimum_temp)

#Calculating max temp
maximum_temp <- max(latest_data$Temperature, na.rm =TRUE)
print(maximum_temp)

#Calculating Mean Temp and round it to 1 decimal place
mean_temp <- mean(latest_data$Temperature, na.rm=TRUE) %>% round(1)
print(mean_temp)

#Number of rows of Temperature Column
length_temp <- length(latest_data$Temperature)
print(length_temp)


```

Above we can see the mean Temperature reported by the  from data in the survey was `r mean_temp` while the maximum temperature recorded was `r maximum_temp` while minimum temperature recorded was `r minimum_temp`.



```{r}
#Number of rows of Visibility as it is categorical only length used.

length_Visibility <-  length(latest_data$Visibility)
print(length_Visibility)
paste0('The Number of Rows in Visibility Column is ', length_Visibility,'.')
```


```{r}

#BAR CHART 1 : Count of each weather type
#Creating a bar chart showing each type of weather and using '#6066A5' color to fill.
#using labs to add titles , x and y axis

latest_data %>%
  ggplot() +
    geom_bar(aes(y = Weather),
             fill='#6066A5') +
    labs(title = 'Different Weather Types', x = 'Count' , y= 'Weather Type')







#BAR CHART 2 : Comparing Temperature and Visibility
#Create a plot Temperature of the first 10 rows of Temperature in latest_data using the x-axis for the Temperature. 
#And fill the color of each bar using the Visibility.
#using labs to add titles , x and y axis

latest_data %>%
  slice(1:10) %>%
  ggplot() +
  geom_bar(aes( x= Temperature,fill= Visibility)) +
  labs(title ="How the Temperature Affects What We See!", 
       subtitle = "Comparing Temperature and Visibility",
       x = 'temp',
       y= 'count')






#BAR CHART 3: 
#We can see How each Weather Types affects the visibility by creating a bar chart

latest_data %>%
  ggplot() +
  geom_bar(aes( x= Weather,fill= Visibility)) +
  labs(title ="How the Visibility Changes according to the type of Weather!", 
       subtitle = "Comparing Weather types and Visibility",
       x = 'Weather Type',
       y= 'count')

```


The first bar chart shows how many times each type of Weather is calculated. While Bar chart 2 shows how Temperature affects Visibility and Bar chart 3 explains how Visibility changes depending on each type of Weather. 